(()=>{var e,t,r={},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var a=o[e]={exports:{}};return r[e](a,a.exports,i),a.exports}i.m=r,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,r)=>(i.f[r](e,t),t)),[])),i.u=e=>"lodestone-id.01d9259586.js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="ffxiv-gearing:",i.l=(r,o,a,n)=>{if(e[r])e[r].push(o);else{var s,c;if(void 0!==a)for(var l=document.getElementsByTagName("script"),d=0;d<l.length;d++){var p=l[d];if(p.getAttribute("src")==r||p.getAttribute("data-webpack")==t+a){s=p;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",t+a),s.src=r),e[r]=[o];var u=(t,o)=>{s.onerror=s.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((e=>e(o))),t)return t(o)},f=setTimeout(u.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=u.bind(null,s.onerror),s.onload=u.bind(null,s.onload),c&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={6:0};i.f.j=(t,r)=>{var o=i.o(e,t)?e[t]:void 0;if(0!==o)if(o)r.push(o[2]);else{var a=new Promise(((r,i)=>o=e[t]=[r,i]));r.push(o[2]=a);var n=i.p+i.u(t),s=new Error;i.l(n,(r=>{if(i.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var a=r&&("load"===r.type?"missing":r.type),n=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+a+": "+n+")",s.name="ChunkLoadError",s.type=a,s.request=n,o[1](s)}}),"chunk-"+t,t)}};var t=(t,r)=>{var o,a,n=r[0],s=r[1],c=r[2],l=0;if(n.some((t=>0!==e[t]))){for(o in s)i.o(s,o)&&(i.m[o]=s[o]);c&&c(i)}for(t&&t(r);l<n.length;l++)a=n[l],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkffxiv_gearing=self.webpackChunkffxiv_gearing||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(async()=>{const e=new URL(document.currentScript.src.replace(/\?[\d.]*$/,"")+"/../").href;i.p=e;const t={job:null,gears:[]},r={6:"PIE",19:"TEN",22:"DHT",27:"CRT",44:"DET",45:"SKS",46:"SPS",10:"GP",11:"CP",70:"CMS",71:"CRL",72:"GTH",73:"PCP"};try{const{characterData:e,ContentGearCalculator:o}=window;if(void 0!==e){const{identifier:r,items:i,materiaData:a}=e.currentSet;for(const e of Object.keys(i)){const r=i[e],o=r.itemID,n=(a[`${e}-${r.itemID}`]||[]).map((e=>{const[t,r]=e.split(":");return[t,Number(r)+1]}));t.gears.push({id:o,materias:n})}t.job=r,t.jobLevel=parseInt(o.currentLevel,10)}const{controller:a}=window;if(void 0!==a?.equipManager){const e={CRIT:"CRT",DH:"DHT",CRFT:"CMS",CNTL:"CRL",GATH:"GTH",PERC:"PCP"},r=(await i.e(151).then(i.bind(i,6768))).default,o={};for(let e=0;e<r.length;e++)void 0!==r[e]&&(o[r[e]]=e);for(const r of Object.values(a.equipManager.equipSelectors)){const i=o[r?.selectedItem?.id];if(void 0!==i){const o=r.selectedMateria?.list?.map((t=>[e[t.key]??t.key,t.tier+1]))??[];t.gears.push({id:i,materias:o})}}const n=o[a.config.conf.meal?.slice(0,11)];void 0!==n&&t.gears.push({id:n,materias:[]}),t.job=a.config.conf.jobId,t.jobLevel=a.config.conf.lvHigh}if(/\betro\b/i.test(document.title)){let e=document.getElementById("root")._reactRootContainer._internalRoot.current;for(;e.child&&!e.memoizedProps?.value?.store;)e=e.child;const o=e.memoizedProps.value.store.getState(),i={};for(const e of o.materia.materiaSelectOptions)i[e.id]=e;const a={};for(const e of o.food.listResult)a[e.id]=e.item;for(const[e,n]of Object.entries(o.gearsets.gearset)){if(!n)continue;let s,{id:c}=n;if(n.baseItemId){c=n.baseItemId,s={};for(let e=0;e<=6;e++){const t=r[n[`param${e}`]],o=n[`param${e}Value`];void 0!==t&&o>0&&(s[t]=o)}}if(c){"food"===e&&(c=a[c]);let n=c;"fingerL"===e&&(n+="L"),"fingerR"===e&&(n+="R");const l=o.gearsets.gearset.materia?.[n],d=[];if(l)for(const[e,t]of Object.entries(l)){const o=i[t];void 0!==o&&o.param in r&&(d[e-1]=[r[o.param],o.tier])}t.gears.push({id:c,materias:d,customStats:s})}}t.job=o.jobs.currentJob.abbrev,t.jobLevel=o.gearsets.gearset.level,t.syncLevel=o.gearsets.gearset.itemLevelSync}const n=document.getElementsByTagName("app-gearset-display")[0];if(void 0!==n){const e=Array.from(document.getElementsByTagName("script"),(e=>e.getAttribute("src"))).find((e=>e?.includes("/main-"))),o=await(await fetch(e)).text(),i=/path:"gearset",loadChildren:\(\)=>import\("([^"]+)"/.exec(o)[1],a=new URL(i,e).href,{GearsetModule:s}=await import(a),c=s.prototype.constructor.ɵinj.imports.find((e=>e.providers)).providers[0].useValue[0].component,{copyToClipboard:l}=c.prototype;let d;c.prototype.copyToClipboard=function(){d=this},n.querySelector('.page-title [nztype="snippets"]').parentNode.click(),c.prototype.copyToClipboard=l;const p=e=>new Promise((t=>{e.subscribe((e=>t(e)))})),u=await p(d.gearset$),f=await p(d.lazyData.getEntry("materias")),m={};f.forEach((e=>{m[e.itemId]=e}));for(const e of Object.values(u))if(e?.itemId){const o=e.materias.map((e=>{const t=m[e];if(!t)return null;const o=r[t.baseParamId];return o?[o,t.tier]:null}));t.gears.push({id:e.itemId,materias:o})}const g=await p(d.food$);g&&t.gears.push({id:g.ID,materias:[]});const b=await p(d.lazyData.getEntry("jobAbbr"));t.job=b[u.job].en,t.jobLevel=await p(d.level$)}const{currentGearSet:s,currentSheet:c}=window;if(void 0!==s?.equipment){const e={crit:"CRT",determination:"DET",dhit:"DHT",skillspeed:"SKS",spellspeed:"SPS",tenacity:"TEN",piety:"PIE"};for(const r of Object.values(s.equipment)){if(!r)continue;const{id:o}=r.gearItem,i=r.melds.map((({equippedMateria:t})=>t&&[e[t.primaryStat],t.materiaGrade]));let a;if(r.relicStats){a={};for(const[t,o]of Object.entries(r.relicStats))o&&(a[e[t]]=o)}t.gears.push({id:o,materias:i,customStats:a})}s.food&&t.gears.push({id:s.food.id,materias:[]}),t.job=c.classJobName,t.jobLevel=c.level,t.syncLevel=c.ilvlSync,665===t.syncLevel&&(t.syncLevel=void 0)}}catch(e){}if(null!==t.job){const r=e+"?import-"+encodeURIComponent(JSON.stringify(t));console.log(r),null===window.open(r)&&prompt("打开此链接进行导入：",r)}else alert("未能在此页面中找到支持导入的数据。")})()})();